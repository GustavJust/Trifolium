---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/hero.astro";
import ImageContainerFacility from "../components/Image_container_facilities.astro";
---

<Layout>
  <Hero
    video="/assets/imgs/video/platform_office_video.mp4"
    title="Facilities"
    description="Trifolium offers modern, flexible facilities designed to support collaboration, innovation, and community across all activities and events."
    descLeft="Woodspace"
    descRight="1st Floor"
    poster="/assets/imgs/lazyload/facilities_lazyload.webp"
  />

  <section>
    <h2>Explore our facilities</h2>
    <nav class="hor_card">
      <a href="/offices"
        ><p>Offices</p><img src="/assets/imgs/arrow_icon_red.svg" alt="" /></a
      >
      <a href="/workshops"
        ><p>Workshops</p><img src="/assets/imgs/arrow_icon_red.svg" alt="" /></a
      >
      <a href="/photostudio"
        ><p>Photo-studio</p><img
          src="/assets/imgs/arrow_icon_red.svg"
          alt=""
        /></a
      >
      <a href="/page_not_found"
        ><p>Meeting & Conferences</p><img
          src="/assets/imgs/arrow_icon_red.svg"
          alt=""
        /></a
      >
      <a href="/page_not_found"
        ><p>Events</p><img src="/assets/imgs/arrow_icon_red.svg" alt="" /></a
      >
    </nav>
  </section>

  <section>
    <h2>
      A professional production village for designers, developers, and builders.
    </h2>
    <p>
      With workspaces, advanced tools, and workshops under one roof, you can
      create physical or digital products from concept to launch.
    </p>

    <div class="map_container">
      <div class="floor_select">
        <p>Floor</p>
        <button class="floor_btn" data-floor="0">1</button>
        <button class="floor_btn" data-floor="1">2</button>
        <button class="floor_btn" data-floor="2">3</button>
      </div>

      <div class="map_frame" id="mapFrame">
        <div class="floor_wrapper">
          <img
            src="/assets/imgs/floor_one_map.svg"
            alt="Floor 1"
            class="floor_img"
          />
          <button class="map_area_btn" data-section="0">Wood workshop</button>
        </div>
        <div class="floor_wrapper">
          <img
            src="/assets/imgs/floor_two_map.svg"
            alt="Floor 2"
            class="floor_img"
          />
        </div>
        <div class="floor_wrapper">
          <img
            src="/assets/imgs/floor_three_map.svg"
            alt="Floor 3"
            class="floor_img"
          />
        </div>
      </div>

      <div class="explanation">
        <div class="explanation-section" data-section="0">
          <div class="thumbnail">
            <h4>AREA A</h4>
            <img src="/assets/imgs/placeholder.png" alt="" />
          </div>
          <div class="card_contents">
            <div class="caption">
              <p>Floor</p>
              <p>Type</p>
            </div>
            <div class="card_desc">
              <p>This is content for Area A.</p>
              <a href="/">Read more</a>
              <div class="image_scroll_facilities">
                <div class="image_container">
                  <ImageContainerFacility
                    src="/assets/imgs/placeholder.png"
                    alt="Map of Trifolium"
                    labelLeft="street view"
                  />
                </div>
                <div class="image_container">
                  <ImageContainerFacility
                    src="/assets/imgs/placeholder.png"
                    alt="Map of Trifolium"
                    labelLeft="street view"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <p>
      With workspaces, advanced tools, and workshops under one roof, you can
      create physical or digital products from concept to launch.
    </p>
    <a href="/contact">
      <button class="large">Get a tour</button>
    </a>
  </section>

  <script is:inline>
    window.addEventListener("DOMContentLoaded", () => {
      // Floor switching logic
      const floorButtons = document.querySelectorAll(".floor_btn");
      const floorWrappers = document.querySelectorAll(".floor_wrapper");

      function setActiveFloor(index) {
        floorWrappers.forEach((wrapper, i) => {
          wrapper.style.display = i === index ? "block" : "none";
        });
      }

      floorButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const index = parseInt(btn.getAttribute("data-floor"), 10);
          if (!isNaN(index)) setActiveFloor(index);
        });
      });

      // Set initial floor to 0
      setActiveFloor(0);

      // Explanation section toggle logic
      const sectionButtons = document.querySelectorAll(".map_area_btn");
      const sections = document.querySelectorAll(".explanation-section");

      function showSection(sectionId) {
        sections.forEach((section) => {
          section.style.display =
            section.dataset.section === sectionId ? "block" : "none";
        });
      }

      sectionButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const sectionId = btn.dataset.section;
          if (sectionId) showSection(sectionId);
        });
      });

      // Set default section visible
      showSection("0");
    });
  </script>

  <style>
    section:not(.hero) {
      margin-left: var(--spacing-small);
      margin-right: var(--spacing-small);
    }
    .map_container {
      margin-top: var(--spacing-medium);
    }
    .floor_select {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: var(--spacing-small);
      margin-bottom: var(--spacing-small);
    }
    .floor_btn {
      background-color: var(--color-white-100);
      border: 1px solid var(--primary-color-500);
      border-radius: 999px;
      width: 40px;
      height: 40px;
      font-weight: 700;
      font-size: 1.5em;
      cursor: pointer;
      z-index: 999;
    }
    .floor_btn:hover {
      background-color: var(--primary-color-300);
    }
    .floor_btn:active {
      background-color: var(--primary-color-500);
      color: white;
    }
    .map_frame {
      width: 100%;
      display: grid;
      grid-template-columns: 1fr;
      position: relative;
    }
    .floor_wrapper {
      position: relative;
      display: none;
    }
    .floor_img {
      width: 100%;
      display: block;
      transform: scale(1.2);
    }
    .map_area_btn {
      position: absolute;
      top: 14%;
      left: 20.5%;
      z-index: 10;
      padding: 1.3em 0.1em;
      font-size: 1rem;
      border: 1px solid var(--primary-color-500);
      background: var(--color-white-100);
      cursor: pointer;
    }
    .explanation {
      margin-top: var(--spacing-medium);
    }
    .explanation-section.hidden {
      display: none;
    }
    .thumbnail {
      width: 100%;
    }
    .thumbnail img {
      width: 100%;
      height: auto;
    }
    .caption {
      display: flex;
      justify-content: space-between;
      text-transform: uppercase;
      margin-top: var(--spacing-tiny);
    }
    .caption p {
      margin: 0;
    }
    .card_desc a {
      text-decoration: underline;
    }
    .hor_card {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-tiny);
    }
    .hor_card > a {
      display: flex;
      justify-content: space-between;
      border: 1px solid var(--primary-color-500);
      font-weight: 700;
      font-size: 1.5em;
      padding: var(--spacing-tiny);
    }
    .hor_card > a:hover {
      background-color: var(--primary-color-200);
    }
    .hor_card > a:active {
      background-color: var(--primary-color-500);
      color: white;
    }
    .hor_card > a img {
      transition: 0.05s ease-in;
    }
    .hor_card > a:hover img {
      rotate: 45deg;
    }
  </style>
</Layout>
